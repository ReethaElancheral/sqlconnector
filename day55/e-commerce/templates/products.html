{% extends "base.html" %}
{% block title %}Products - Flask Shop{% endblock %}
{% block content %}
  <h1>All Products</h1>
  <div class="grid">
    {% for p in products %}
      <div class="card">
        {% if p.image_url %}<img src="{{ p.image_url }}" alt="{{ p.name }}">{% endif %}
        <h3>{{ p.name }}</h3>
        <p class="price">${{ '%.2f' % (p.price_cents / 100.0) }}</p>
        <p class="desc">{{ (p.description or '')[:160] }}{% if (p.description or '')|length > 160 %}â€¦{% endif %}</p>
        {% if current_user.is_authenticated %}
          <button class="btn add-to-cart" data-product-id="{{ p.id }}">Add to Cart</button>
        {% else %}
          <a class="btn" href="{{ url_for('auth.login') }}">Login to Buy</a>
        {% endif %}
      </div>
    {% endfor %}
  </div>
{% endblock %}
